#!/usr/bin/env python3
"""
Ïó∞Í≤∞Îêú Digital Experience Intelligence Platform
Health Ïπ¥ÎìúÏôÄ Î©îÎâ¥Ïóê Í∏∞Ï°¥ ÌéòÏù¥ÏßÄÎì§ÏùÑ Ïó∞Í≤∞Ìïú ÌîåÎû´Ìèº
"""

from fastapi import FastAPI, Request, Query
from fastapi.responses import HTMLResponse, RedirectResponse
from datetime import datetime
import uvicorn

# FastAPI Ïï± ÏÉùÏÑ±
web_app = FastAPI(title="Digital Experience Intelligence Platform", version="2.0.0")

def get_available_languages():
    """ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïñ∏Ïñ¥ Î™©Î°ù Î∞òÌôò"""
    return ["ko", "en", "zh"]

@web_app.get("/", response_class=HTMLResponse)
async def root():
    """Î£®Ìä∏ ÌéòÏù¥ÏßÄ - Health ÌéòÏù¥ÏßÄÎ°ú Î¶¨Îã§Ïù¥Î†âÌä∏"""
    return RedirectResponse(url="/health?lang=ko")

@web_app.get("/health", response_class=HTMLResponse)
async def health_page(request: Request, lang: str = Query("ko", description="Language code")):
    """Ïó∞Í≤∞Îêú Digital Experience Intelligence Platform"""
    # Ïñ∏Ïñ¥ ÏÑ§Ï†ï
    if lang not in get_available_languages():
        lang = "ko"
    
    return f"""
    <!DOCTYPE html>
    <html lang="{lang}">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>üîç Digital Experience Intelligence Platform</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <style>
            body {{
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            }}
            .main-container {{
                max-width: 1400px;
                margin: 0 auto;
                padding: 20px;
            }}
            .header-card {{
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 40px;
                margin-bottom: 30px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                text-align: center;
            }}
            .system-status-grid {{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
                margin: 30px 0;
            }}
            .system-card {{
                background: rgba(255, 255, 255, 0.9);
                border-radius: 15px;
                padding: 25px;
                text-align: center;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                transition: all 0.3s ease;
                cursor: pointer;
            }}
            .system-card:hover {{
                transform: translateY(-5px);
                box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            }}
            .status-indicator {{
                width: 12px;
                height: 12px;
                border-radius: 50%;
                display: inline-block;
                margin-right: 8px;
            }}
            .status-online {{ background-color: #28a745; }}
            .status-offline {{ background-color: #dc3545; }}
            .status-warning {{ background-color: #ffc107; }}
            .feature-grid {{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 25px;
                margin-bottom: 30px;
            }}
            .feature-card {{
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 30px;
                box-shadow: 0 15px 35px rgba(0,0,0,0.1);
                transition: all 0.3s ease;
                border-left: 5px solid #667eea;
                cursor: pointer;
            }}
            .feature-card:hover {{
                transform: translateY(-10px);
                box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            }}
            .feature-icon {{
                font-size: 3rem;
                margin-bottom: 20px;
                background: linear-gradient(135deg, #667eea, #764ba2);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }}
            .interaction-tracker {{
                background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                color: white;
            }}
            .ai-insights {{
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }}
            .session-replay {{
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                color: white;
            }}
            .privacy-protection {{
                background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                color: white;
            }}
            .real-time-monitoring {{
                background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                color: white;
            }}
            .flexible-deployment {{
                background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
                color: #333;
            }}
            .stats-grid {{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin: 20px 0;
            }}
            .stat-card {{
                background: rgba(255, 255, 255, 0.9);
                border-radius: 15px;
                padding: 20px;
                text-align: center;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            }}
            .stat-value {{
                font-size: 2.5rem;
                font-weight: bold;
                color: #667eea;
                margin-bottom: 10px;
            }}
            .stat-label {{
                color: #666;
                font-size: 0.9rem;
                text-transform: uppercase;
                letter-spacing: 1px;
            }}
            .progress-modern {{
                height: 8px;
                border-radius: 10px;
                background: rgba(255,255,255,0.3);
                overflow: hidden;
                margin: 15px 0;
            }}
            .progress-bar-modern {{
                height: 100%;
                background: linear-gradient(90deg, #4facfe, #00f2fe);
                border-radius: 10px;
                transition: width 0.3s ease;
            }}
            .ai-chat {{
                background: rgba(255,255,255,0.1);
                border-radius: 15px;
                padding: 20px;
                margin: 20px 0;
                max-height: 300px;
                overflow-y: auto;
            }}
            .ai-message {{
                margin: 10px 0;
                padding: 15px;
                border-radius: 15px;
                max-width: 80%;
            }}
            .ai-user {{
                background: rgba(255,255,255,0.2);
                margin-left: auto;
            }}
            .ai-assistant {{
                background: rgba(255,255,255,0.1);
            }}
            .heatmap-container {{
                background: rgba(255,255,255,0.1);
                border-radius: 15px;
                padding: 20px;
                margin: 20px 0;
                position: relative;
                height: 200px;
            }}
            .heatmap-point {{
                position: absolute;
                width: 12px;
                height: 12px;
                background: #ff6b6b;
                border-radius: 50%;
                opacity: 0.8;
                animation: pulse 2s infinite;
            }}
            @keyframes pulse {{
                0% {{ transform: scale(1); opacity: 0.8; }}
                50% {{ transform: scale(1.2); opacity: 0.6; }}
                100% {{ transform: scale(1); opacity: 0.8; }}
            }}
            .alert-modern {{
                border-radius: 15px;
                border: none;
                padding: 15px 20px;
                margin: 10px 0;
                backdrop-filter: blur(10px);
            }}
            .btn-modern {{
                border-radius: 25px;
                padding: 12px 30px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
                transition: all 0.3s ease;
                border: none;
            }}
            .btn-modern:hover {{
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            }}
            .language-selector {{
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
            }}
            .uptime-display {{
                font-family: 'Courier New', monospace;
                font-size: 1.2rem;
                color: #28a745;
                font-weight: bold;
            }}
            .link-indicator {{
                color: #007bff;
                font-size: 0.8rem;
                margin-top: 10px;
            }}
        </style>
    </head>
    <body>
        <!-- Ïñ∏Ïñ¥ ÏÑ†ÌÉùÍ∏∞ -->
        <div class="language-selector">
            <div class="btn-group" role="group">
                <a href="?lang=ko" class="btn btn-light btn-sm">üá∞üá∑ ÌïúÍµ≠Ïñ¥</a>
                <a href="?lang=en" class="btn btn-light btn-sm">üá∫üá∏ English</a>
                <a href="?lang=zh" class="btn btn-light btn-sm">üá®üá≥ ‰∏≠Êñá</a>
            </div>
        </div>

        <div class="main-container">
            <!-- Ìó§Îçî -->
            <div class="header-card">
                <h1 class="display-4 mb-4">
                    <i class="fas fa-brain"></i> Digital Experience Intelligence Platform
                </h1>
                <p class="lead mb-4">Ìè¨Í¥ÑÏ†ÅÏù∏ ÏÇ¨Ïö©Ïûê Í≤ΩÌóò Î∂ÑÏÑù Î∞è ÏµúÏ†ÅÌôî ÏÜîÎ£®ÏÖò</p>
                
                <!-- Ïã§ÏãúÍ∞Ñ ÌÜµÍ≥Ñ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalInteractions">0</div>
                        <div class="stat-label">Ï¥ù ÏÉÅÌò∏ÏûëÏö©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeSessions">0</div>
                        <div class="stat-label">ÌôúÏÑ± ÏÑ∏ÏÖò</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="conversionRate">0%</div>
                        <div class="stat-label">Ï†ÑÌôòÏú®</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="errorRate">0%</div>
                        <div class="stat-label">Ïò§Î•òÏú®</div>
                    </div>
                </div>
            </div>

            <!-- ÏãúÏä§ÌÖú ÏÉÅÌÉú (Health Ïπ¥ÎìúÎì§) -->
            <div class="system-status-grid">
                <div class="system-card" onclick="window.location.href='/?lang={lang}'">
                    <i class="fas fa-server fa-3x text-success mb-3"></i>
                    <h5>Web Server</h5>
                    <p>
                        <span class="status-indicator status-online"></span>
                        <strong>Online</strong>
                    </p>
                    <small class="text-muted">Port: 8000</small>
                    <div class="link-indicator">
                        üîó Î©îÏù∏ ÎåÄÏãúÎ≥¥ÎìúÎ°ú Ïù¥Îèô
                    </div>
                </div>
                
                <div class="system-card" onclick="window.location.href='/api/health'">
                    <i class="fas fa-cogs fa-3x text-primary mb-3"></i>
                    <h5>API Services</h5>
                    <p>
                        <span class="status-indicator status-online"></span>
                        <strong>Healthy</strong>
                    </p>
                    <small class="text-muted">All endpoints active</small>
                    <div class="link-indicator">
                        üîó API ÏÉÅÌÉú ÌôïÏù∏
                    </div>
                </div>
                
                <div class="system-card" onclick="window.location.href='/data-collection?lang={lang}'">
                    <i class="fas fa-database fa-3x text-info mb-3"></i>
                    <h5>Data Storage</h5>
                    <p>
                        <span class="status-indicator status-online"></span>
                        <strong>Connected</strong>
                    </p>
                    <small class="text-muted">SQLite Database</small>
                    <div class="link-indicator">
                        üîó Îç∞Ïù¥ÌÑ∞ ÏàòÏßë ÌéòÏù¥ÏßÄ
                    </div>
                </div>
                
                <div class="system-card" onclick="window.location.href='/statistics?lang={lang}'">
                    <i class="fas fa-clock fa-3x text-warning mb-3"></i>
                    <h5>Uptime</h5>
                    <p class="uptime-display" id="uptime">Calculating...</p>
                    <small class="text-muted">Last Update: <span id="lastUpdate"></span></small>
                    <div class="link-indicator">
                        üîó ÌÜµÍ≥Ñ ÌéòÏù¥ÏßÄ
                    </div>
                </div>
            </div>

            <!-- Í∏∞Îä• Ïπ¥ÎìúÎì§ (Î©îÎâ¥) -->
            <div class="feature-grid">
                <!-- Ïã§ÏãúÍ∞Ñ Ïù¥Î≤§Ìä∏ Ï∫°Ï≤ò -->
                <div class="feature-card interaction-tracker" onclick="window.location.href='/data-analysis?lang={lang}'">
                    <div class="feature-icon">
                        <i class="fas fa-mouse-pointer"></i>
                    </div>
                    <h3>Ïã§ÏãúÍ∞Ñ Ïù¥Î≤§Ìä∏ Ï∫°Ï≤ò</h3>
                    <p>ÌÅ¥Î¶≠, Ïä§ÌÅ¨Î°§, Ìèº Ï†úÏ∂ú Îì± Î™®Îì† ÏÇ¨Ïö©Ïûê ÏÉÅÌò∏ÏûëÏö©ÏùÑ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Ï∂îÏ†ÅÌï©ÎãàÎã§.</p>
                    
                    <div class="progress-modern">
                        <div class="progress-bar-modern" style="width: 95%"></div>
                    </div>
                    <small>ÌîÑÎ°†Ìä∏ÏóîÎìú Ïù¥Î≤§Ìä∏ Ï∫°Ï≤òÏú®: 95%</small>
                    
                    <div class="progress-modern">
                        <div class="progress-bar-modern" style="width: 98%"></div>
                    </div>
                    <small>Î∞±ÏóîÎìú API Ìò∏Ï∂ú Ï∫°Ï≤òÏú®: 98%</small>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/data-analysis?lang={lang}'">
                            <i class="fas fa-chart-line"></i> Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù ÌéòÏù¥ÏßÄ
                        </button>
                    </div>
                </div>

                <!-- AI Ïù∏ÏÇ¨Ïù¥Ìä∏ -->
                <div class="feature-card ai-insights" onclick="window.location.href='/llm-slm?lang={lang}'">
                    <div class="feature-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>AI Ïù∏ÏÇ¨Ïù¥Ìä∏ (SLM Í∏∞Î∞ò)</h3>
                    <p>Small Language Model Í∏∞Î∞ò ÎåÄÌôîÌòï Î∂ÑÏÑù Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏Î°ú Ïã¨Ï∏µÏ†ÅÏù∏ Ïù∏ÏÇ¨Ïù¥Ìä∏Î•º Ï†úÍ≥µÌï©ÎãàÎã§.</p>
                    
                    <div class="ai-chat" id="aiChat">
                        <div class="ai-message ai-assistant">
                            <strong>AI Assistant:</strong> ÏïàÎÖïÌïòÏÑ∏Ïöî! ÏÇ¨Ïö©Ïûê Í≤ΩÌóò Î∂ÑÏÑùÏùÑ ÎèÑÏôÄÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.
                        </div>
                        <div class="ai-message ai-user">
                            Ï†ÑÌôòÏú®ÏùÑ Í∞úÏÑ†ÌïòÎäî Î∞©Î≤ïÏùÑ ÏïåÎ†§Ï£ºÏÑ∏Ïöî
                        </div>
                        <div class="ai-message ai-assistant">
                            <strong>AI Assistant:</strong> Î∂ÑÏÑù Í≤∞Í≥º, 3Îã®Í≥ÑÏóêÏÑú Ïù¥ÌÉàÎ•†Ïù¥ ÎÜíÏäµÎãàÎã§. CTA Î≤ÑÌäº ÏúÑÏπòÎ•º Ï°∞Ï†ïÌï¥Î≥¥ÏÑ∏Ïöî.
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/llm-slm?lang={lang}'">
                            <i class="fas fa-brain"></i> LLM-SLM Í∞úÎ∞ú ÌéòÏù¥ÏßÄ
                        </button>
                    </div>
                </div>

                <!-- ÏÑ∏ÏÖò Î¶¨ÌîåÎ†àÏù¥ -->
                <div class="feature-card session-replay" onclick="window.location.href='/weather-analysis?lang={lang}'">
                    <div class="feature-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <h3>ÏÑ∏ÏÖò Î¶¨ÌîåÎ†àÏù¥</h3>
                    <p>ÏÇ¨Ïö©Ïûê ÌñâÎèô Ìå®ÌÑ¥ÏùÑ ÏãúÍ∞ÅÌôîÌïòÍ≥† ÌûàÌä∏ÎßµÏúºÎ°ú ÎßàÏ∞∞ ÏßÄÏ†êÏùÑ Î∂ÑÏÑùÌï©ÎãàÎã§.</p>
                    
                    <div class="heatmap-container" id="heatmapContainer">
                        <div class="heatmap-point" style="top: 20px; left: 30px;"></div>
                        <div class="heatmap-point" style="top: 50px; left: 80px;"></div>
                        <div class="heatmap-point" style="top: 80px; left: 120px;"></div>
                        <div class="heatmap-point" style="top: 120px; left: 200px;"></div>
                        <div class="heatmap-point" style="top: 150px; left: 250px;"></div>
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/weather-analysis?lang={lang}'">
                            <i class="fas fa-cloud-sun"></i> ÎÇ†Ïî® Î∂ÑÏÑù ÌéòÏù¥ÏßÄ
                        </button>
                    </div>
                </div>

                <!-- ÌîÑÎùºÏù¥Î≤ÑÏãú Î≥¥Ìò∏ -->
                <div class="feature-card privacy-protection" onclick="window.location.href='/model-testing?lang={lang}'">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>ÌîÑÎùºÏù¥Î≤ÑÏãú Î≥¥Ìò∏</h3>
                    <p>PII, PCI, PHI Îì± ÎØºÍ∞êÌïú Îç∞Ïù¥ÌÑ∞Î•º ÏûêÎèôÏúºÎ°ú ÎßàÏä§ÌÇπÌïòÏó¨ Î≥¥ÏïàÏùÑ Î≥¥Ïû•Ìï©ÎãàÎã§.</p>
                    
                    <div class="alert alert-modern alert-success">
                        <i class="fas fa-check-circle"></i> PII Îç∞Ïù¥ÌÑ∞ ÎßàÏä§ÌÇπ: 100% ÌôúÏÑ±
                    </div>
                    <div class="alert alert-modern alert-success">
                        <i class="fas fa-check-circle"></i> PCI Îç∞Ïù¥ÌÑ∞ ÎßàÏä§ÌÇπ: 100% ÌôúÏÑ±
                    </div>
                    <div class="alert alert-modern alert-success">
                        <i class="fas fa-check-circle"></i> PHI Îç∞Ïù¥ÌÑ∞ ÎßàÏä§ÌÇπ: 100% ÌôúÏÑ±
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/model-testing?lang={lang}'">
                            <i class="fas fa-cogs"></i> ML/AI ÏóîÏßÑ ÌéòÏù¥ÏßÄ
                        </button>
                    </div>
                </div>

                <!-- Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ -->
                <div class="feature-card real-time-monitoring" onclick="window.location.href='/weather-dashboard?lang={lang}'">
                    <div class="feature-icon">
                        <i class="fas fa-bell"></i>
                    </div>
                    <h3>Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ</h3>
                    <p>Ï†ÑÌôòÏú® Î≥ÄÌôî, Ïò§Î•ò Í∞êÏßÄ, ÏÇ¨Ïö©Ïûê Î∂àÌé∏ÏùÑ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î™®ÎãàÌÑ∞ÎßÅÌïòÍ≥† ÏïåÎ¶ºÌï©ÎãàÎã§.</p>
                    
                    <div class="alert alert-modern alert-warning">
                        <i class="fas fa-exclamation-triangle"></i> Ï†ÑÌôòÏú® 15% Í∞êÏÜå Í∞êÏßÄ
                    </div>
                    <div class="alert alert-modern alert-info">
                        <i class="fas fa-info-circle"></i> ÏÉàÎ°úÏö¥ ÏÇ¨Ïö©Ïûê ÏÑ∏ÏÖò ÏãúÏûë
                    </div>
                    <div class="alert alert-modern alert-success">
                        <i class="fas fa-check-circle"></i> ÏãúÏä§ÌÖú Ï†ïÏÉÅ ÏûëÎèô
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/weather-dashboard?lang={lang}'">
                            <i class="fas fa-chart-area"></i> ÎÇ†Ïî® ÎåÄÏãúÎ≥¥Îìú
                        </button>
                    </div>
                </div>

                <!-- Ïú†Ïó∞Ìïú Î∞∞Ìè¨ -->
                <div class="feature-card flexible-deployment" onclick="window.location.href='/api/dashboard'">
                    <div class="feature-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>Ïú†Ïó∞Ìïú Î∞∞Ìè¨</h3>
                    <p>ÌïòÏù¥Î∏åÎ¶¨Îìú, Ïã±Í∏Ä ÌÖåÎÑåÌä∏, Î©ÄÌã∞ ÌÖåÎÑåÌä∏ ÌôòÍ≤ΩÏùÑ ÏßÄÏõêÌï©ÎãàÎã§.</p>
                    
                    <div class="row">
                        <div class="col-4 text-center">
                            <i class="fas fa-cloud fa-2x mb-2" style="color: #667eea;"></i>
                            <div class="small">ÌïòÏù¥Î∏åÎ¶¨Îìú</div>
                            <span class="badge bg-primary">ÌôúÏÑ±</span>
                        </div>
                        <div class="col-4 text-center">
                            <i class="fas fa-server fa-2x mb-2" style="color: #28a745;"></i>
                            <div class="small">Ïã±Í∏Ä ÌÖåÎÑåÌä∏</div>
                            <span class="badge bg-success">ÏÇ¨Ïö© Í∞ÄÎä•</span>
                        </div>
                        <div class="col-4 text-center">
                            <i class="fas fa-users fa-2x mb-2" style="color: #17a2b8;"></i>
                            <div class="small">Î©ÄÌã∞ ÌÖåÎÑåÌä∏</div>
                            <span class="badge bg-info">ÏÇ¨Ïö© Í∞ÄÎä•</span>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <button class="btn btn-light btn-modern" onclick="event.stopPropagation(); window.location.href='/api/dashboard'">
                            <i class="fas fa-chart-bar"></i> API ÎåÄÏãúÎ≥¥Îìú
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // Ïã§ÏãúÍ∞Ñ ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            function updateStats() {{
                document.getElementById('totalInteractions').textContent = (Math.floor(Math.random() * 1000) + 1000).toLocaleString();
                document.getElementById('activeSessions').textContent = Math.floor(Math.random() * 50) + 10;
                document.getElementById('conversionRate').textContent = (Math.random() * 10 + 5).toFixed(1) + '%';
                document.getElementById('errorRate').textContent = (Math.random() * 2).toFixed(2) + '%';
            }}

            // ÌûàÌä∏Îßµ ÏóÖÎç∞Ïù¥Ìä∏
            function generateHeatmap() {{
                const container = document.getElementById('heatmapContainer');
                const points = container.querySelectorAll('.heatmap-point');
                points.forEach(point => {{
                    point.style.top = Math.random() * 180 + 'px';
                    point.style.left = Math.random() * 300 + 'px';
                }});
            }}

            // ÏóÖÌÉÄÏûÑ Í≥ÑÏÇ∞
            function updateUptime() {{
                const startTime = new Date('2025-10-11T01:22:47Z');
                const now = new Date();
                const diff = now - startTime;
                
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('uptime').textContent = `${{hours}}h ${{minutes}}m ${{seconds}}s`;
            }}

            // Ï¥àÍ∏∞Ìôî
            document.addEventListener('DOMContentLoaded', function() {{
                updateStats();
                updateUptime();
                setInterval(updateStats, 5000); // 5Ï¥àÎßàÎã§ ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
                setInterval(updateUptime, 1000); // 1Ï¥àÎßàÎã§ ÏóÖÌÉÄÏûÑ ÏóÖÎç∞Ïù¥Ìä∏
                setInterval(generateHeatmap, 10000); // 10Ï¥àÎßàÎã§ ÌûàÌä∏Îßµ ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            }});
        </script>
    </body>
    </html>
    """

@web_app.get("/digital-experience", response_class=HTMLResponse)
async def digital_experience_page(request: Request, lang: str = Query("ko", description="Language code")):
    """Digital Experience Intelligence Ï†ÑÏö© ÌéòÏù¥ÏßÄ - Î¶¨Îã§Ïù¥Î†âÌä∏Ïö©"""
    # /healthÎ°ú Î¶¨Îã§Ïù¥Î†âÌä∏
    return RedirectResponse(url=f"/health?lang={lang}")

# API ÏóîÎìúÌè¨Ïù∏Ìä∏Îì§
@web_app.get("/api/health")
async def api_health():
    """API Health Check"""
    return {
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "version": "2.0.0",
        "services": {
            "web_interface": "online",
            "api": "online",
            "database": "online"
        }
    }

@web_app.get("/api/dashboard")
async def api_dashboard():
    """Dashboard API"""
    return {
        "message": "Dashboard API is working",
        "timestamp": datetime.now().isoformat()
    }

@web_app.get("/api/models")
async def api_models():
    """Models API"""
    return {
        "message": "Models API is working",
        "timestamp": datetime.now().isoformat()
    }

@web_app.get("/api/statistics")
async def api_statistics():
    """Statistics API"""
    return {
        "message": "Statistics API is working",
        "timestamp": datetime.now().isoformat()
    }

@web_app.get("/api/languages")
async def api_languages():
    """Languages API"""
    return {
        "languages": get_available_languages(),
        "current": "ko",
        "timestamp": datetime.now().isoformat()
    }

if __name__ == "__main__":
    uvicorn.run(web_app, host="0.0.0.0", port=8000)
